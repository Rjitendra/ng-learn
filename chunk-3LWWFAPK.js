import{a as it}from"./chunk-43LAY5TB.js";import{a as A,d as B,g as Q}from"./chunk-OKCFBVKY.js";import{a as X,b as Y,c as Z,d as tt,e as et}from"./chunk-5SPK6VSF.js";import{a as O,d as J,e as U,f as j,g as G,h as R,i as $,k as z,l as H,m as K}from"./chunk-AJWFTP3L.js";import"./chunk-J6JTIABC.js";import{J as W,K as q,N as L}from"./chunk-WGHRGTKE.js";import"./chunk-7TRG72WA.js";import{l as F}from"./chunk-ATW432D2.js";import{Ab as V,Bb as E,Cb as x,Db as d,Eb as o,Fb as k,Kb as S,Mb as g,Ob as _,Ua as l,Yb as C,a as f,ac as c,b as v,dc as T,eb as D,ec as b,fa as P,fc as M,gc as h,ka as s,la as m,rc as I,sc as N,ta as y,wb as p,xb as u}from"./chunk-IDVU2DUC.js";var ot=(r,i)=>i.id;function rt(r,i){r&1&&(d(0,"mat-error"),c(1,"Title is required"),o())}function at(r,i){r&1&&(d(0,"mat-error"),c(1,"Description is required"),o())}function dt(r,i){r&1&&(d(0,"mat-error"),c(1,"Price is required"),o())}function lt(r,i){if(r&1){let t=S();d(0,"div",5)(1,"mat-card")(2,"form",null,0)(4,"mat-form-field",7)(5,"mat-label"),c(6,"Title"),o(),d(7,"input",8,1),h("ngModelChange",function(e){let a=s(t);return M(a.title,e)||(a.title=e),m(e)}),o(),p(9,rt,2,0,"mat-error"),o(),d(10,"mat-form-field",7)(11,"mat-label"),c(12,"Description"),o(),d(13,"input",9,2),h("ngModelChange",function(e){let a=s(t);return M(a.description,e)||(a.description=e),m(e)}),o(),p(15,at,2,0,"mat-error"),o(),d(16,"mat-form-field",7)(17,"mat-label"),c(18,"Price"),o(),d(19,"input",10,3),h("ngModelChange",function(e){let a=s(t);return M(a.price,e)||(a.price=e),m(e)}),o(),p(21,dt,2,0,"mat-error"),o(),d(22,"div",11)(23,"button",12),g("click",function(){s(t);let e=_();return m(e.save())}),c(24," Save "),o(),d(25,"button",13),g("click",function(){s(t);let e=_();return m(e.saveAsDraft())}),c(26," Save As Draft "),o()()()()()}if(r&2){let t=i,n=C(3),e=C(8),a=C(14),w=C(20);l(7),b("ngModel",t.title),l(2),u(e.invalid&&e.touched?9:-1),l(4),b("ngModel",t.description),l(2),u(a.invalid&&a.touched?15:-1),l(4),b("ngModel",t.price),l(2),u(w.invalid&&w.touched?21:-1),l(2),x("disabled",!n.form.valid),l(2),x("disabled",!n.form.valid)}}function ct(r,i){if(r&1){let t=S();d(0,"button",22),g("click",function(){s(t);let e=_().$implicit,a=_(2);return m(a.discardDraft(e))}),c(1," Discard Draft "),o()}}function st(r,i){if(r&1){let t=S();d(0,"mat-card",15)(1,"div",16)(2,"div",17),c(3),o(),d(4,"div",18)(5,"button",19),g("click",function(){let e=s(t).$implicit,a=_(2);return m(a.edit(e))}),c(6," Edit "),o(),d(7,"button",20),g("click",function(){let e=s(t).$implicit,a=_(2);return m(a.delete(e))}),c(8," Delete "),o(),p(9,ct,2,0,"button",21),o()()()}if(r&2){let t=i.$implicit;l(3),T("",t.title," - \u20B9",t.price),l(6),u(t.isValid?-1:9)}}function mt(r,i){r&1&&(d(0,"div",6)(1,"div",14),V(2,st,10,3,"mat-card",15,ot),o()()),r&2&&(l(2),E(i))}var nt=class r{products=y([]);model=y(this.getEmptyProduct());validProducts=I(()=>this.products().filter(i=>!i.isDeleted));productService=P(it);constructor(){this.loadProducts(),N(()=>{console.log(`\u{1F4AC} Model changed: ${JSON.stringify(this.model())}`),console.log(`\u{1F4AC} Valid Products: ${JSON.stringify(this.validProducts())}`)})}save(){let i=this.model(),t=i.id===0?0:1;this.productService.save(v(f({},i),{operationType:t,isValid:!0})).subscribe(n=>{this.upsertProduct(n),this.model.set(this.getEmptyProduct())})}saveAsDraft(){let i=this.model(),t=i.id===0?0:1;this.productService.save(v(f({},i),{operationType:t,isValid:!1})).subscribe(n=>{this.upsertProduct(n),this.model.set(this.getEmptyProduct())})}edit(i){this.model.set(f({},i))}delete(i){this.productService.save(v(f({},i),{operationType:2})).subscribe(t=>{this.products.update(n=>n.filter(e=>e.pkId!==t.pkId))})}discardDraft(i){this.productService.discardDraft(i).subscribe(t=>{t?this.upsertProduct(t):this.products.update(n=>n.filter(e=>e.pkId!==i.pkId)),this.model.set(this.getEmptyProduct())})}upsertProduct(i){this.products.update(t=>{let n=t.findIndex(e=>e.pkId===i.pkId);if(n!==-1){let e=[...t];return e[n]=i,e}return[...t,i]})}getEmptyProduct(){return{id:0,title:"",description:"",price:0,isValid:!0,operationType:0}}loadProducts(){this.productService.getAll().subscribe(i=>{this.products.set(i.filter(t=>!t.isDeleted))})}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=D({type:r,selectors:[["ng-signal"]],decls:5,vars:2,consts:[["productForm","ngForm"],["title","ngModel"],["description","ngModel"],["price","ngModel"],[1,"page-title"],[1,"form-container"],[1,"list-container"],["appearance","fill",1,"form-field"],["matInput","","name","title","required","",3,"ngModelChange","ngModel"],["matInput","","name","description","required","",3,"ngModelChange","ngModel"],["matInput","","type","number","name","price","required","","min","0",3,"ngModelChange","ngModel"],[1,"button-group"],["type","button","mat-raised-button","","color","primary",3,"click","disabled"],["type","button","mat-raised-button","","color","accent",3,"click","disabled"],[1,"grid-wrapper"],[1,"product-card"],[1,"card-content"],[1,"product-title"],[1,"product-actions"],["type","button","mat-stroked-button","","color","primary",3,"click"],["type","button","mat-stroked-button","","color","warn",3,"click"],["type","button","mat-stroked-button","","color","accent"],["type","button","mat-stroked-button","","color","accent",3,"click"]],template:function(t,n){if(t&1&&(d(0,"h1",4),c(1,"Product Manager (Angular Signal)"),o(),p(2,lt,27,8,"div",5),k(3,"hr"),p(4,mt,4,0,"div",6)),t&2){let e,a;l(2),u((e=n.model())?2:-1,e),l(2),u((a=n.products())?4:-1,a)}},dependencies:[F,K,R,O,$,J,U,H,z,G,j,et,tt,Z,X,Y,q,W,B,A,Q,L],encapsulation:2})};export{nt as SignalComponent};
