import{a as dt}from"./chunk-43LAY5TB.js";import{a as O,d as L,g as tt}from"./chunk-OKCFBVKY.js";import{a as et,b as it,c as ot,d as nt,e as rt}from"./chunk-5SPK6VSF.js";import{a as R,d as G,e as z,f as H,g as J,h as K,i as Q,k as X,l as Y,m as Z}from"./chunk-AJWFTP3L.js";import"./chunk-J6JTIABC.js";import{J as q,K as A,N as U}from"./chunk-WGHRGTKE.js";import"./chunk-7TRG72WA.js";import{k as N,l as W}from"./chunk-ATW432D2.js";import{Ab as T,Bb as $,Cb as I,Db as c,Eb as r,Fb as j,Kb as x,Mb as b,Ob as _,Ua as a,Y as h,Yb as v,a as C,ac as l,b as g,dc as F,eb as V,ec as P,fa as M,fc as y,gc as S,k as E,ka as s,la as p,lc as w,mc as D,n as f,wb as u,xb as m,yc as B}from"./chunk-IDVU2DUC.js";var at=(d,o)=>o.id;function lt(d,o){d&1&&(c(0,"mat-error"),l(1,"Title is required"),r())}function st(d,o){d&1&&(c(0,"mat-error"),l(1,"Description is required"),r())}function pt(d,o){d&1&&(c(0,"mat-error"),l(1,"Price is required"),r())}function ut(d,o){if(d&1){let i=x();c(0,"div",5)(1,"mat-card")(2,"form",null,0)(4,"mat-form-field",7)(5,"mat-label"),l(6,"Title"),r(),c(7,"input",8,1),S("ngModelChange",function(t){let e=s(i);return y(e.title,t)||(e.title=t),p(t)}),r(),u(9,lt,2,0,"mat-error"),r(),c(10,"mat-form-field",7)(11,"mat-label"),l(12,"Description"),r(),c(13,"input",9,2),S("ngModelChange",function(t){let e=s(i);return y(e.description,t)||(e.description=t),p(t)}),r(),u(15,st,2,0,"mat-error"),r(),c(16,"mat-form-field",7)(17,"mat-label"),l(18,"Price"),r(),c(19,"input",10,3),S("ngModelChange",function(t){let e=s(i);return y(e.price,t)||(e.price=t),p(t)}),r(),u(21,pt,2,0,"mat-error"),r(),c(22,"div",11)(23,"button",12),b("click",function(){s(i);let t=_();return p(t.save())}),l(24," Save "),r(),c(25,"button",13),b("click",function(){s(i);let t=_();return p(t.saveAsDraft())}),l(26," Save As Draft "),r()()()()()}if(d&2){let i=o,n=v(3),t=v(8),e=v(14),k=v(20);a(7),P("ngModel",i.title),a(2),m(t.invalid&&t.touched?9:-1),a(4),P("ngModel",i.description),a(2),m(e.invalid&&e.touched?15:-1),a(4),P("ngModel",i.price),a(2),m(k.invalid&&k.touched?21:-1),a(2),I("disabled",!n.form.valid),a(2),I("disabled",!n.form.valid)}}function mt(d,o){if(d&1){let i=x();c(0,"button",22),b("click",function(){s(i);let t=_().$implicit,e=_(2);return p(e.disCardDraft(t))}),l(1," Discard Draft "),r()}}function _t(d,o){if(d&1){let i=x();c(0,"mat-card",15)(1,"div",16)(2,"div",17),l(3),r(),c(4,"div",18)(5,"button",19),b("click",function(){let t=s(i).$implicit,e=_(2);return p(e.edit(t))}),l(6," Edit "),r(),c(7,"button",20),b("click",function(){let t=s(i).$implicit,e=_(2);return p(e.delete(t))}),l(8," Delete "),r(),u(9,mt,2,0,"button",21),r()()()}if(d&2){let i=o.$implicit;a(3),F("",i.title," - \u20B9",i.price),a(6),m(i.isValid?-1:9)}}function Ct(d,o){d&1&&(c(0,"div",6)(1,"div",14),T(2,_t,10,3,"mat-card",15,at),r()()),d&2&&(a(2),$(o))}var ct=class d{modelSubject=new E(this.getEmptyProduct());products$;products=[];model$=this.modelSubject.asObservable();productService=M(dt);$cd=M(B);constructor(){}ngOnInit(){this.products$=this.productService.getAll().pipe(h(o=>{this.products=o.filter(i=>i.isDeleted===!1)}))}save(){let o=this.modelSubject.value.id===0?0:1;this.productService.save(g(C({},this.modelSubject.value),{operationType:o,isValid:!0})).pipe(h(n=>{if(o===0)this.products.push(n);else{let t=this.products.findIndex(e=>e.pkId===n.pkId);this.products[t]=n}this.products$=f([...this.products]),this.$cd.detectChanges(),this.modelSubject.next(this.getEmptyProduct())})).subscribe()}saveAsDraft(){let o=this.modelSubject.value.id===0?0:1;this.productService.save(g(C({},this.modelSubject.value),{operationType:o,isValid:!1})).pipe(h(n=>{if(o===0)this.products.push(n);else{let t=this.products.findIndex(e=>e.pkId===n.pkId);this.products[t]=n}this.products$=f([...this.products]),this.$cd.detectChanges(),this.modelSubject.next(this.getEmptyProduct())})).subscribe()}edit(o){this.modelSubject.next(g(C({},o),{operationType:1}))}delete(o){this.productService.save(g(C({},o),{operationType:2})).pipe(h(n=>{let t=this.products.findIndex(e=>e.pkId===n.pkId);t!==-1&&(this.products.splice(t,1),this.products$=f([...this.products])),this.$cd.detectChanges(),this.modelSubject.next(this.getEmptyProduct())})).subscribe()}disCardDraft(o){this.productService.discardDraft(C({},o)).pipe(h(n=>{if(n){let t=this.products.findIndex(e=>e.pkId===n.pkId);t!==-1&&(this.products[t]=n,this.products$=f([...this.products]))}else{let t=this.products.findIndex(e=>e.pkId===o.pkId);t!==-1&&(this.products.splice(t,1),this.products$=f([...this.products]))}this.$cd.detectChanges(),this.modelSubject.next(this.getEmptyProduct())})).subscribe()}getEmptyProduct(){return{id:0,title:"",description:"",price:0,isValid:!0,operationType:0}}static \u0275fac=function(i){return new(i||d)};static \u0275cmp=V({type:d,selectors:[["ng-product-crud"]],decls:7,vars:6,consts:[["productForm","ngForm"],["title","ngModel"],["description","ngModel"],["price","ngModel"],[1,"page-title"],[1,"form-container"],[1,"list-container"],["appearance","fill",1,"form-field"],["matInput","","name","title","required","",3,"ngModelChange","ngModel"],["matInput","","name","description","required","",3,"ngModelChange","ngModel"],["matInput","","type","number","name","price","required","","min","0",3,"ngModelChange","ngModel"],[1,"button-group"],["type","button","mat-raised-button","","color","primary",3,"click","disabled"],["type","button","mat-raised-button","","color","accent",3,"click","disabled"],[1,"grid-wrapper"],[1,"product-card"],[1,"card-content"],[1,"product-title"],[1,"product-actions"],["type","button","mat-stroked-button","","color","primary",3,"click"],["type","button","mat-stroked-button","","color","warn",3,"click"],["type","button","mat-stroked-button","","color","accent"],["type","button","mat-stroked-button","","color","accent",3,"click"]],template:function(i,n){if(i&1&&(c(0,"h1",4),l(1,"Product Manager"),r(),u(2,ut,27,8,"div",5),w(3,"async"),j(4,"hr"),u(5,Ct,4,0,"div",6),w(6,"async")),i&2){let t,e;a(2),m((t=D(3,2,n.model$))?2:-1,t),a(3),m((e=D(6,4,n.products$))?5:-1,e)}},dependencies:[W,Z,K,R,Q,G,z,Y,X,J,H,rt,nt,ot,et,it,A,q,L,O,tt,U,N],encapsulation:2,changeDetection:0})};export{ct as ProductCrudComponent};
